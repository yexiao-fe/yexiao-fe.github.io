## 过程

```bash
输入网址。 
浏览器查找域名的IP地址。 
浏览器给web服务器发送一个HTTP请求 
网站服务的永久重定向响应 
浏览器跟踪重定向地址 现在，浏览器知道了要访问的正确地址，所以它会发送另一个获取请求。 
服务器“处理”请求，服务器接收到获取请求，然后处理并返回一个响应。 
服务器发回一个HTML响应 
浏览器开始显示HTML 
浏览器发送请求，以获取嵌入在HTML中的对象。在浏览器显示HTML时，它会注意到需要获取其他地址内容的标签。这时，浏览器会发送一个获取请求来重新获得这些文件。这些文件就包括CSS/JS/图片等资源，这些资源的地址都要经历一个和HTML读取类似的过程。所以浏览器会在DNS中查找这些域名，发送请求，重定向等等…
```

<!-- more -->

浏览器会解析三个东西:

```bash
HTML/SVG/XHTML，解析这三种文件会产生一个 DOM Tree。 
CSS，解析 CSS 会产生 CSS 规则树。 
Javascript脚本，主要是通过 DOM API 和 CSSOM API 来操作 DOM Tree 和 CSS Rule Tree。
```

## 回流与重绘

Reflow（回流）

```bash
浏览器要花时间去渲染，当它发现了某个部分发生了变化影响了布局，那就需要倒回去重新渲染。 
```

Repaint（重绘）

```bash
如果只是改变了某个元素的背景颜色，文字颜色等，不影响元素周围或内部布局的属性，将只会引起浏览器的repaint，重画某一部分。
```

```bash
注意：Reflow要比Repaint更花费时间，也就更影响性能，要尽量避免过多的Reflow
```

### 回流的原因

```bash
页面初始化的时候； 
操作DOM时； 
某些元素的尺寸变了； 
CSS 的属性发生变化。
```

### 减少 reflow/repaint

```bash
不要一条一条地修改 DOM 的样式。与其这样，还不如预先定义好 css 的 class，然后修改 DOM 的 className。 
不要把 DOM 结点的属性值放在一个循环里当成循环里的变量。 
为动画的 HTML 元件使用 fixed 或 absoult 的 position，那么修改他们的 CSS 是不会 reflow 的。 
千万不要使用 table 布局。因为可能很小的一个小改动会造成整个 table 的重新布局。
```

## HTML页面加载和解析流程 

```bash
用户输入网址（假设是个html页面，并且是第一次访问），浏览器向服务器发出请求，服务器返回html文件； 
浏览器开始载入html代码，发现＜head＞标签内有一个＜link＞标签引用外部CSS文件； 
浏览器又发出CSS文件的请求，服务器返回这个CSS文件； 
浏览器继续载入html中＜body＞部分的代码，并且CSS文件已经拿到手了，可以开始渲染页面了； 
浏览器在代码中发现一个＜img＞标签引用了一张图片，向服务器发出请求。此时浏览器不会等到图片下载完，而是继续渲染后面的代码； 
服务器返回图片文件，由于图片占用了一定面积，影响了后面段落的排布，因此浏览器需要回过头来重新渲染这部分代码； 
浏览器发现了一个包含一行Javascript代码的＜script＞标签，赶快运行它； 
Javascript脚本执行了这条语句，它命令浏览器隐藏掉代码中的某个＜div＞ （style.display=”none”）。突然少了这么一个元素，浏览器不得不重新渲染这部分代码； 
终于等到了＜/html＞的到来，浏览器泪流满面…… 
等等，还没完，用户点了一下界面中的“换肤”按钮，Javascript让浏览器换了一下＜link＞标签的CSS路径； 
浏览器召集了在座的各位＜div＞＜span＞＜ul＞＜li＞们，“大伙儿收拾收拾行李，咱得重新来过……”，浏览器向服务器请求了新的CSS文件，重新渲染页面。
```

## 代码编写的注意事项

### 编写CSS

CSS选择符是**从右到左**进行匹配的。匹配 #nav li 时，会去找所有的li，然后再去确定它的父元素是不是#nav。

```bash
dom深度尽量浅。
减少inline javascript、css的数量。
使用现代合法的css属性。
不要为id选择器指定类名或是标签，因为id可以唯一确定一个元素。
避免后代选择符，尽量使用子选择符。原因：子元素匹配符的概率要大于后代元素匹配符。后代选择符;#tp p{} 子选择符：#tp>p{}
避免使用通配符，举一个例子，.mod .hd *{font-size:14px;} 根据匹配顺序,将首先匹配通配符,也就是说先匹配出通配符,然后匹配.hd（就是要对dom树上的所有节点进行遍历他的父级元素）,然后匹配.mod,这样的性能耗费可想而知.
```

### script标签的位置

```bash
我们大都会将script标签放在body结束标签之前
```

Javascript的加载和执行的特点： 

```bash
载入后马上执行； 
执行时会阻塞页面后续的内容（包括页面的渲染、其它资源的下载）。原因：因为浏览器需要一个稳定的DOM树结构，而JS中很有可能有 代码直接改变了DOM树结构，比如使用 document.write 或 appendChild,甚至是直接使用的location.href进行跳转，浏览器为了防止出现JS修 改DOM树，需要重新构建DOM树的情况，所以 就会阻塞其他的下载和呈现。
```

减少 JavaScript 对性能的影响的方法：

```bash
将所有的script标签放到页面底部，也就是body闭合标签之前，这能确保在脚本执行前页面已经完成了DOM树渲染。
尽可能地合并脚本。页面中的script标签越少，加载也就越快，响应也越迅速。无论是外链脚本还是内嵌脚本都是如此。
采用无阻塞下载 JavaScript 脚本的方法： 
（1）使用script标签的 defer 属性（仅适用于 IE 和 Firefox 3.5 以上版本）； 
（2）使用动态创建的script元素来下载并执行代码；
```